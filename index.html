<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
  <meta name="description" content="Recuerdo Amable ‚Äî Tu asistente digital de recordatorios y bienestar diario">
  <title>Recuerdo Amable</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link href="https://fonts.googleapis.com/css2?family=Merriweather:wght@400;700&family=Nunito:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    *, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }

    :root {
      --body: 'Nunito', sans-serif;
      --head: 'Merriweather', serif;
      --text: #2C2F3E;
      --muted: #6B6D7B;
      --light: #9B9DAB;
      --card: #FDFCFA;
      --green: #5A9E7A;
      --red: #D45D3F;
      --purple: #7B6DAF;
      --shadow: 0 2px 16px rgba(44,47,62,0.07);
      --radius: 20px;
    }

    body {
      min-height: 100vh;
      background: linear-gradient(160deg, #FFFBF5 0%, #F5EDE3 40%, #EDE5D8 100%);
      font-family: var(--body);
      color: var(--text);
      -webkit-font-smoothing: antialiased;
    }

    button, [role="button"] { min-height: 48px; min-width: 48px; cursor: pointer; }

    .wrap { max-width: 520px; margin: 0 auto; padding: 20px 16px 120px; }

    /* Animations */
    .fi { opacity: 0; transform: translateY(12px); animation: fu 0.5s ease forwards; }
    .d1 { animation-delay: 0.08s; } .d2 { animation-delay: 0.16s; }
    .d3 { animation-delay: 0.24s; } .d4 { animation-delay: 0.32s; }
    @keyframes fu { to { opacity: 1; transform: translateY(0); } }
    @keyframes fadeIn { from { opacity: 0; } to { opacity: 1; } }
    @keyframes slideUp { from { transform: translateY(100%); } to { transform: translateY(0); } }
    @keyframes pop { 0% { transform: scale(0.9); } 50% { transform: scale(1.05); } 100% { transform: scale(1); } }
    @keyframes checkPop { 0% { transform: scale(1); } 50% { transform: scale(1.25); } 100% { transform: scale(1); } }

    /* ‚îÄ‚îÄ Saludo ‚îÄ‚îÄ */
    .saludo {
      background: linear-gradient(135deg, var(--card) 0%, #F7F0E6 100%);
      border-radius: var(--radius); padding: 28px 24px; margin-bottom: 16px;
      box-shadow: var(--shadow); position: relative; overflow: hidden;
    }
    .saludo::after {
      content: ''; position: absolute; top: -40%; right: -20%; width: 180px; height: 180px;
      border-radius: 50%; background: radial-gradient(circle, rgba(242,204,143,0.25) 0%, transparent 70%);
    }
    .fecha { font-size: 15px; color: var(--light); font-weight: 600; letter-spacing: 0.3px; margin-bottom: 4px; }
    .saludo-h { font-family: var(--head); font-size: 30px; color: var(--text); line-height: 1.2; }
    .saludo-msg {
      font-size: 17px; color: var(--muted); line-height: 1.6;
      margin-top: 16px; padding-top: 16px; border-top: 1px solid rgba(44,47,62,0.06);
      font-style: italic;
    }

    /* Sound Toggle */
    .sound-toggle {
      position: absolute; top: 16px; right: 16px; z-index: 2;
      background: rgba(44,47,62,0.05); border: none; border-radius: 12px;
      width: 48px; height: 48px; display: flex; align-items: center; justify-content: center;
      font-size: 22px; transition: background 0.2s;
    }
    .sound-toggle:hover { background: rgba(44,47,62,0.1); }

    /* ‚îÄ‚îÄ Progreso ‚îÄ‚îÄ */
    .prog {
      background: var(--card); border-radius: var(--radius); padding: 22px 24px; margin-bottom: 16px;
      box-shadow: var(--shadow);
    }
    .prog-row { display: flex; justify-content: space-between; align-items: center; margin-bottom: 14px; }
    .prog-lbl { font-size: 14px; font-weight: 700; color: var(--light); text-transform: uppercase; letter-spacing: 1.2px; }
    .prog-num { font-family: var(--head); font-size: 22px; color: var(--green); }
    .prog-bg { width: 100%; height: 12px; background: #EDE7DC; border-radius: 100px; overflow: hidden; }
    .prog-fill {
      height: 100%; border-radius: 100px; transition: width 0.8s cubic-bezier(0.4,0,0.2,1);
      background: linear-gradient(90deg, var(--green), #78C49A); width: 0%;
    }
    .prog-txt { font-size: 15px; color: var(--muted); margin-top: 12px; font-weight: 500; text-align: center; }

    /* ‚îÄ‚îÄ √Ånimo ‚îÄ‚îÄ */
    .mood {
      background: var(--card); border-radius: var(--radius); padding: 24px; margin-bottom: 16px;
      box-shadow: var(--shadow);
    }
    .mood-h { font-family: var(--head); font-size: 22px; color: var(--text); margin-bottom: 18px; }
    .mood-grid { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; }
    .mood-btn {
      width: 88px; height: 88px; border-radius: 20px;
      border: 3px solid rgba(44,47,62,0.07); background: #FAF7F2;
      transition: all 0.25s; display: flex; flex-direction: column;
      align-items: center; justify-content: center; gap: 4px;
    }
    .mood-btn:hover { border-color: rgba(44,47,62,0.15); transform: translateY(-2px); }
    .mood-btn.sel { border-color: var(--green); background: rgba(90,158,122,0.08); transform: translateY(-2px); animation: pop 0.3s ease; }
    .mood-e { font-size: 36px; line-height: 1; }
    .mood-lb { font-size: 13px; font-weight: 700; color: var(--muted); }
    .mood-resp {
      font-size: 17px; color: var(--green); font-weight: 600;
      text-align: center; margin-top: 18px; animation: fu 0.4s ease forwards; line-height: 1.5;
      opacity: 0;
    }

    /* ‚îÄ‚îÄ Tabs ‚îÄ‚îÄ */
    .tabs {
      display: flex; gap: 4px; background: rgba(44,47,62,0.05);
      border-radius: 16px; padding: 5px; margin-bottom: 16px;
    }
    .tab-b {
      flex: 1; padding: 14px 0; border: none; background: transparent;
      font-family: var(--body); font-size: 16px; font-weight: 700;
      color: var(--light); border-radius: 12px; transition: all 0.3s;
    }
    .tab-b.act { background: var(--card); color: var(--text); box-shadow: 0 2px 8px rgba(44,47,62,0.08); }

    /* ‚îÄ‚îÄ Reminder Cards ‚îÄ‚îÄ */
    .rc {
      background: var(--card); border-radius: 18px; padding: 18px 20px; margin-bottom: 12px;
      display: flex; align-items: center; gap: 16px;
      box-shadow: 0 1px 10px rgba(44,47,62,0.05); transition: all 0.25s; cursor: pointer;
      border-left: 5px solid transparent;
    }
    .rc:hover { box-shadow: 0 4px 20px rgba(44,47,62,0.1); }
    .rc:active { transform: scale(0.99); }
    .rc.done { opacity: 0.5; background: #F5F2ED; }
    .rc.done .rc-txt { text-decoration: line-through; color: var(--light); }

    .rc-chk {
      width: 48px; height: 48px; border-radius: 50%; border: 3px solid;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; transition: all 0.3s; font-size: 22px; font-weight: 700;
      background: transparent;
    }
    .rc-chk.on { color: white !important; animation: checkPop 0.3s ease; }

    .rc-body { flex: 1; min-width: 0; }
    .rc-txt { font-size: 18px; font-weight: 600; color: var(--text); line-height: 1.35; margin-bottom: 4px; }
    .rc-time { font-size: 14px; color: var(--light); font-weight: 600; display: flex; align-items: center; gap: 8px; }
    .rc-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; display: inline-block; }

    .rc-del {
      background: rgba(212,93,63,0.08); border: none; color: var(--red);
      width: 48px; height: 48px; border-radius: 14px; font-size: 24px; font-weight: 700;
      display: flex; align-items: center; justify-content: center;
      flex-shrink: 0; transition: all 0.2s;
    }
    .rc-del:hover { background: rgba(212,93,63,0.15); }

    /* ‚îÄ‚îÄ Delete Confirm ‚îÄ‚îÄ */
    .del-confirm {
      background: #FFF5F2; border: 2px solid rgba(212,93,63,0.2); border-radius: 18px;
      padding: 20px; margin-bottom: 12px; text-align: center;
    }
    .del-msg { font-size: 17px; color: var(--text); font-weight: 600; margin-bottom: 16px; line-height: 1.4; }
    .del-btns { display: flex; gap: 12px; }
    .del-yes {
      flex: 1; padding: 14px; border: none; border-radius: 14px;
      background: var(--red); color: white; font-family: var(--body);
      font-size: 16px; font-weight: 700;
    }
    .del-no {
      flex: 1; padding: 14px; border: 2px solid rgba(44,47,62,0.1); border-radius: 14px;
      background: white; color: var(--text); font-family: var(--body);
      font-size: 16px; font-weight: 700;
    }

    /* ‚îÄ‚îÄ Form ‚îÄ‚îÄ */
    .aform {
      background: var(--card); border-radius: var(--radius); padding: 28px 24px; margin-bottom: 16px;
      box-shadow: 0 4px 28px rgba(44,47,62,0.1); animation: fu 0.3s ease;
      display: none;
    }
    .aform.open { display: block; }
    .flbl { font-size: 14px; font-weight: 800; color: var(--light); text-transform: uppercase; letter-spacing: 1.2px; margin-bottom: 10px; display: block; }
    .finp {
      width: 100%; padding: 16px 18px; border: 2px solid rgba(44,47,62,0.1);
      border-radius: 14px; font-family: var(--body); font-size: 18px;
      color: var(--text); background: #FAF8F4; outline: none; transition: border-color 0.3s; margin-bottom: 20px;
    }
    .finp:focus { border-color: var(--green); }
    .fsel {
      width: 100%; padding: 16px 18px; border: 2px solid rgba(44,47,62,0.1);
      border-radius: 14px; font-family: var(--body); font-size: 18px;
      color: var(--text); background: #FAF8F4; outline: none; margin-bottom: 20px;
      appearance: none; -webkit-appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg width='14' height='9' viewBox='0 0 14 9' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M1 1L7 7L13 1' stroke='%239B9DAB' stroke-width='2' stroke-linecap='round'/%3E%3C/svg%3E");
      background-repeat: no-repeat; background-position: right 18px center;
    }
    .cpills { display: flex; flex-wrap: wrap; gap: 10px; margin-bottom: 20px; }
    .cpill {
      padding: 12px 18px; border-radius: 100px; border: 2px solid rgba(44,47,62,0.08);
      background: transparent; font-family: var(--body); font-size: 15px;
      font-weight: 700; color: var(--muted); transition: all 0.2s;
    }
    .cpill.sel { color: white; border-color: transparent; }
    .fbtns { display: flex; gap: 12px; }
    .btn-go {
      flex: 1; padding: 16px; border: none; border-radius: 14px;
      background: linear-gradient(135deg, var(--green), #489E6A);
      color: white; font-family: var(--body); font-size: 17px; font-weight: 700;
      transition: all 0.3s;
    }
    .btn-go:hover { transform: translateY(-1px); box-shadow: 0 4px 16px rgba(90,158,122,0.3); }
    .btn-cancel {
      padding: 16px 24px; border: 2px solid rgba(44,47,62,0.1); border-radius: 14px;
      background: transparent; color: var(--muted); font-family: var(--body);
      font-size: 17px; font-weight: 700;
    }

    /* ‚îÄ‚îÄ FABs ‚îÄ‚îÄ */
    .fab-add {
      position: fixed; bottom: 24px; right: calc(50% - 244px);
      width: 64px; height: 64px; border-radius: 50%; border: none;
      background: linear-gradient(135deg, var(--red), #C04A30);
      color: white; font-size: 32px; font-weight: 300;
      box-shadow: 0 6px 24px rgba(212,93,63,0.4);
      display: flex; align-items: center; justify-content: center; transition: all 0.3s; z-index: 10;
    }
    .fab-add:hover { transform: scale(1.08); }

    .fab-ci {
      position: fixed; bottom: 24px; left: calc(50% - 244px);
      height: 64px; padding: 0 28px; border-radius: 100px; border: none;
      background: linear-gradient(135deg, var(--purple), #6A5C9E);
      color: white; font-family: var(--body); font-size: 17px; font-weight: 700;
      box-shadow: 0 6px 24px rgba(123,109,175,0.35);
      display: flex; align-items: center; gap: 10px; transition: all 0.3s; z-index: 10;
    }
    .fab-ci:hover { transform: scale(1.04); }

    /* ‚îÄ‚îÄ Check-in Overlay ‚îÄ‚îÄ */
    .overlay {
      position: fixed; inset: 0; background: rgba(44,47,62,0.35);
      backdrop-filter: blur(8px); display: none; align-items: flex-end;
      justify-content: center; z-index: 100; animation: fadeIn 0.3s ease;
    }
    .overlay.open { display: flex; }
    .sheet {
      background: var(--card); border-radius: 28px 28px 0 0; padding: 32px 24px 40px;
      width: 100%; max-width: 520px; max-height: 88vh; overflow-y: auto;
      animation: slideUp 0.4s cubic-bezier(0.16,1,0.3,1);
    }
    .handle { width: 48px; height: 5px; background: rgba(44,47,62,0.12); border-radius: 100px; margin: 0 auto 24px; }
    .ci-t { font-family: var(--head); font-size: 26px; color: var(--text); margin-bottom: 8px; }
    .ci-sub { font-size: 17px; color: var(--muted); margin-bottom: 28px; line-height: 1.5; }
    .ci-ta {
      width: 100%; padding: 18px; border: 2px solid rgba(44,47,62,0.1);
      border-radius: 16px; font-family: var(--body); font-size: 18px;
      color: var(--text); background: #FAF8F4; outline: none; resize: none;
      min-height: 120px; line-height: 1.6; margin-bottom: 24px;
    }
    .ci-ta:focus { border-color: var(--purple); }
    .ci-ok { text-align: center; padding: 48px 0; }
    .ci-ok-e { font-size: 56px; margin-bottom: 20px; }
    .ci-ok-t { font-family: var(--head); font-size: 22px; color: var(--text); }
    .ci-ok-sub { font-size: 17px; color: var(--muted); margin-top: 10px; }

    .empty { text-align: center; padding: 48px 20px; }
    .empty-e { font-size: 48px; margin-bottom: 16px; }
    .empty-t { font-size: 18px; color: var(--muted); line-height: 1.6; font-weight: 500; }

    .hidden { display: none !important; }

    .ci-mood-grid { display: flex; gap: 10px; flex-wrap: wrap; justify-content: center; margin-bottom: 24px; }
    .ci-mood-btn {
      width: 80px; height: 80px; border-radius: 18px;
      border: 3px solid rgba(44,47,62,0.07); background: #FAF7F2;
      transition: all 0.25s; display: flex; flex-direction: column;
      align-items: center; justify-content: center; gap: 4px; cursor: pointer;
    }
    .ci-mood-btn:hover { border-color: rgba(44,47,62,0.15); }
    .ci-mood-btn.sel { border-color: var(--green); background: rgba(90,158,122,0.08); }

    @media (max-width: 560px) {
      .fab-add { right: 20px; }
      .fab-ci { left: 20px; }
      .mood-btn { width: 60px; height: 76px; border-radius: 16px; }
      .mood-e { font-size: 30px; }
      .mood-lb { font-size: 12px; }
      .ci-mood-btn { width: 60px; height: 72px; }
    }
  </style>
</head>
<body>
  <div class="wrap">

    <!-- Saludo -->
    <div class="saludo fi" id="saludo">
      <button class="sound-toggle" id="soundBtn" aria-label="Activar/Desactivar sonido">üîä</button>
      <p class="fecha" id="fecha"></p>
      <h1 class="saludo-h" id="saludoText"></h1>
      <p class="saludo-msg" id="mensajeDiario"></p>
    </div>

    <!-- Progreso -->
    <div class="prog fi d1">
      <div class="prog-row">
        <span class="prog-lbl">Progreso de Hoy</span>
        <span class="prog-num" id="progNum">0/0</span>
      </div>
      <div class="prog-bg">
        <div class="prog-fill" id="progFill"></div>
      </div>
      <p class="prog-txt" id="progTxt"></p>
    </div>

    <!-- √Ånimo -->
    <div class="mood fi d2">
      <h2 class="mood-h">¬øC√≥mo te sientes? üíõ</h2>
      <div class="mood-grid" id="moodGrid"></div>
      <p class="mood-resp" id="moodResp"></p>
    </div>

    <!-- Tabs -->
    <div class="tabs fi d3">
      <button class="tab-b act" id="tabHoy" onclick="switchTab('hoy')">Pendientes (0)</button>
      <button class="tab-b" id="tabListo" onclick="switchTab('listo')">Hechos (0)</button>
    </div>

    <!-- Add Form -->
    <div class="aform" id="addForm">
      <label class="flbl">¬øQu√© te recuerdo?</label>
      <input class="finp" id="newText" type="text" placeholder="Ej: Tomar medicina de la noche...">
      <label class="flbl">¬øA qu√© hora?</label>
      <select class="fsel" id="newTime"></select>
      <label class="flbl">Categor√≠a</label>
      <div class="cpills" id="catPills"></div>
      <div class="fbtns">
        <button class="btn-cancel" onclick="toggleForm()">Cancelar</button>
        <button class="btn-go" onclick="addReminder()">Agregar ‚úì</button>
      </div>
    </div>

    <!-- Reminder List -->
    <div class="fi d4" id="reminderList"></div>

    <!-- FABs -->
    <button class="fab-ci" onclick="openCheckin()">üíú ¬øC√≥mo vas?</button>
    <button class="fab-add" id="fabAdd" onclick="toggleForm()">+</button>

    <!-- Check-in Overlay -->
    <div class="overlay" id="checkinOverlay" onclick="closeCheckinBg(event)">
      <div class="sheet">
        <div class="handle"></div>
        <div id="checkinContent">
          <h2 class="ci-t">Tu Momento üåø</h2>
          <p class="ci-sub">T√≥mate un momento para ti. ¬øC√≥mo va tu d√≠a? Sin presi√≥n ‚Äî este espacio es tuyo.</p>
          <label class="flbl">¬øC√≥mo te sientes ahora?</label>
          <div class="ci-mood-grid" id="ciMoodGrid"></div>
          <label class="flbl">¬øAlgo en tu mente? (opcional)</label>
          <textarea class="ci-ta" id="ciNote" placeholder="Me siento..."></textarea>
          <button class="btn-go" style="width:100%;padding:18px;font-size:18px" onclick="submitCheckin()">Enviar Check-in üíõ</button>
        </div>
        <div id="checkinSuccess" class="hidden">
          <div class="ci-ok">
            <div class="ci-ok-e">üíú</div>
            <div class="ci-ok-t">Gracias por registrarte.</div>
            <p class="ci-ok-sub">Est√°s haciendo algo hermoso por ti.</p>
          </div>
        </div>
      </div>
    </div>

  </div>

  <script>
    /* ‚îÄ‚îÄ‚îÄ State ‚îÄ‚îÄ‚îÄ */
    let soundOn = true;
    let currentTab = 'hoy';
    let currentMood = null;
    let ciMood = null;
    let confirmDelId = null;
    let formOpen = false;
    let newCat = 'personal';

    const CATS = [
      { id: 'salud', label: 'Salud', icon: 'üíä', color: '#D45D3F' },
      { id: 'comida', label: 'Comida', icon: 'üçΩÔ∏è', color: '#5A9E7A' },
      { id: 'movimiento', label: 'Movimiento', icon: 'üö∂', color: '#C49530' },
      { id: 'social', label: 'Social', icon: 'üí¨', color: '#3D405B' },
      { id: 'descanso', label: 'Descanso', icon: 'üò¥', color: '#7B6DAF' },
      { id: 'personal', label: 'Personal', icon: '‚ú®', color: '#C47E55' },
    ];

    const MENSAJES = [
      "Lo est√°s haciendo bien. Un paso a la vez. üåø",
      "Tu bienestar importa. Gracias por estar presente. ‚òÄÔ∏è",
      "Est√° bien ir despacio. Vas a tu tiempo.",
      "Cuidarte es un acto de amor propio. üíõ",
      "Hoy es un buen d√≠a para ser bueno contigo. üå∫",
      "Cada peque√±a acci√≥n suma algo hermoso.",
      "Respira profundo. T√∫ puedes con esto. üåä",
      "No tienes que ser perfecto. Solo tienes que ser t√∫. ü§ô",
    ];

    const MOODS = [
      { emoji: 'üòä', label: 'Genial', val: 'genial' },
      { emoji: 'üôÇ', label: 'Bien', val: 'bien' },
      { emoji: 'üòê', label: 'Ah√≠', val: 'ahi' },
      { emoji: 'üòî', label: 'Bajito', val: 'bajito' },
      { emoji: 'üò∞', label: 'Dif√≠cil', val: 'dificil' },
    ];

    const MOOD_RESP = {
      genial: '¬°Qu√© bueno! Vamos con esa energ√≠a. üåü',
      bien: 'Me alegra escuchar eso. Vas muy bien. üíö',
      ahi: 'Est√° bien. Cada d√≠a es diferente. üå§Ô∏è',
      bajito: 'Estoy aqu√≠ contigo. S√© amable contigo hoy. üíõ',
      dificil: 'Siento que est√© dif√≠cil. No est√°s solo/a. ü§ó',
    };

    const HORAS = [
      '6:00 AM','6:30 AM','7:00 AM','7:30 AM','8:00 AM','8:30 AM',
      '9:00 AM','9:30 AM','10:00 AM','10:30 AM','11:00 AM','11:30 AM',
      '12:00 PM','12:30 PM','1:00 PM','1:30 PM','2:00 PM','2:30 PM',
      '3:00 PM','3:30 PM','4:00 PM','4:30 PM','5:00 PM','5:30 PM',
      '6:00 PM','6:30 PM','7:00 PM','7:30 PM','8:00 PM','8:30 PM',
      '9:00 PM','9:30 PM','10:00 PM',
    ];

    let reminders = [
      { id: 1, text: 'Tomar medicamento de la ma√±ana', time: '8:00 AM', cat: 'salud', done: false },
      { id: 2, text: 'Tomar un vaso de agua', time: '9:00 AM', cat: 'salud', done: false },
      { id: 3, text: 'Almorzar algo nutritivo', time: '12:00 PM', cat: 'comida', done: false },
      { id: 4, text: 'Caminar 15 minutos', time: '2:00 PM', cat: 'movimiento', done: false },
      { id: 5, text: 'Llamar a un familiar o amigo', time: '4:00 PM', cat: 'social', done: false },
      { id: 6, text: 'Relajarse ‚Äî sin pantallas', time: '9:00 PM', cat: 'descanso', done: false },
    ];

    /* ‚îÄ‚îÄ‚îÄ Audio Engine (Conga-inspired) ‚îÄ‚îÄ‚îÄ */
    function playTone(type) {
      if (!soundOn) return;
      try {
        const ctx = new (window.AudioContext || window.webkitAudioContext)();
        const osc = ctx.createOscillator();
        const gain = ctx.createGain();
        osc.connect(gain);
        gain.connect(ctx.destination);

        if (type === 'complete') {
          osc.type = 'triangle';
          osc.frequency.setValueAtTime(280, ctx.currentTime);
          osc.frequency.exponentialRampToValueAtTime(120, ctx.currentTime + 0.15);
          gain.gain.setValueAtTime(0.4, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.2);
          osc.start(ctx.currentTime); osc.stop(ctx.currentTime + 0.2);
        } else if (type === 'undo') {
          osc.type = 'sine';
          osc.frequency.setValueAtTime(200, ctx.currentTime);
          gain.gain.setValueAtTime(0.2, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.12);
          osc.start(ctx.currentTime); osc.stop(ctx.currentTime + 0.12);
        } else if (type === 'add') {
          osc.type = 'triangle';
          osc.frequency.setValueAtTime(400, ctx.currentTime);
          osc.frequency.exponentialRampToValueAtTime(180, ctx.currentTime + 0.12);
          gain.gain.setValueAtTime(0.35, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.18);
          osc.start(ctx.currentTime); osc.stop(ctx.currentTime + 0.18);
        } else if (type === 'checkin') {
          const osc2 = ctx.createOscillator();
          const gain2 = ctx.createGain();
          osc2.connect(gain2); gain2.connect(ctx.destination);
          osc.type = 'sine'; osc2.type = 'sine';
          osc.frequency.setValueAtTime(260, ctx.currentTime);
          osc2.frequency.setValueAtTime(330, ctx.currentTime);
          gain.gain.setValueAtTime(0.25, ctx.currentTime);
          gain2.gain.setValueAtTime(0.2, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
          gain2.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.5);
          osc.start(ctx.currentTime); osc2.start(ctx.currentTime);
          osc.stop(ctx.currentTime + 0.5); osc2.stop(ctx.currentTime + 0.5);
        } else if (type === 'mood') {
          osc.type = 'sine';
          osc.frequency.setValueAtTime(320, ctx.currentTime);
          gain.gain.setValueAtTime(0.15, ctx.currentTime);
          gain.gain.exponentialRampToValueAtTime(0.01, ctx.currentTime + 0.15);
          osc.start(ctx.currentTime); osc.stop(ctx.currentTime + 0.15);
        }
      } catch (e) { /* silent */ }
    }

    /* ‚îÄ‚îÄ‚îÄ Helpers ‚îÄ‚îÄ‚îÄ */
    function getCatColor(id) { return CATS.find(c => c.id === id)?.color || '#999'; }
    function getCatIcon(id) { return CATS.find(c => c.id === id)?.icon || 'üìå'; }

    function formatFecha(d) {
      const dias = ['Domingo','Lunes','Martes','Mi√©rcoles','Jueves','Viernes','S√°bado'];
      const meses = ['enero','febrero','marzo','abril','mayo','junio','julio','agosto','septiembre','octubre','noviembre','diciembre'];
      return `${dias[d.getDay()]}, ${d.getDate()} de ${meses[d.getMonth()]}`;
    }

    function getSaludo() {
      const h = new Date().getHours();
      if (h < 12) return 'Buenos d√≠as';
      if (h < 17) return 'Buenas tardes';
      return 'Buenas noches';
    }

    /* ‚îÄ‚îÄ‚îÄ Render ‚îÄ‚îÄ‚îÄ */
    function render() {
      const doneCount = reminders.filter(r => r.done).length;
      const total = reminders.length;
      const pct = total > 0 ? (doneCount / total) * 100 : 0;
      const pendientes = reminders.filter(r => !r.done);
      const completados = reminders.filter(r => r.done);

      // Progress
      document.getElementById('progNum').textContent = `${doneCount}/${total}`;
      document.getElementById('progFill').style.width = `${pct}%`;
      const progTxt = document.getElementById('progTxt');
      if (doneCount > 0 && doneCount < total) {
        progTxt.textContent = doneCount === 1 ? '¬°Buen comienzo!' : `¬°Ya van ${doneCount}! Sigue as√≠.`;
      } else if (doneCount === total && total > 0) {
        progTxt.textContent = 'üéâ ¬°Completaste todo! ¬°Tremendo!';
      } else {
        progTxt.textContent = '';
      }

      // Tabs
      document.getElementById('tabHoy').textContent = `Pendientes (${pendientes.length})`;
      document.getElementById('tabListo').textContent = `Hechos (${completados.length})`;

      // List
      const list = document.getElementById('reminderList');
      const items = currentTab === 'hoy' ? pendientes : completados;

      if (items.length === 0) {
        const emptyMsg = currentTab === 'hoy'
          ? '<div class="empty-e">üéâ</div><div class="empty-t">¬°Todo listo por hoy!<br>Te luciste. Descansa tranquilo/a.</div>'
          : '<div class="empty-e">‚è≥</div><div class="empty-t">Nada completado a√∫n.<br>Toca un recordatorio para marcarlo.</div>';
        list.innerHTML = `<div class="empty">${emptyMsg}</div>`;
        return;
      }

      let html = '';
      items.forEach(r => {
        const color = getCatColor(r.cat);
        if (confirmDelId === r.id) {
          html += `
            <div class="del-confirm">
              <p class="del-msg">¬øSeguro que quieres borrar<br>"${r.text}"?</p>
              <div class="del-btns">
                <button class="del-no" onclick="cancelDel()">No, dejar</button>
                <button class="del-yes" onclick="confirmDelete(${r.id})">S√≠, borrar</button>
              </div>
            </div>`;
        } else {
          const doneClass = r.done ? ' done' : '';
          const chkClass = r.done ? ' on' : '';
          const chkStyle = r.done
            ? `border-color:${color};background:${color};color:white`
            : `border-color:${color};color:${color}`;
          const chkContent = r.done ? '‚úì' : '';
          const delBtn = r.done ? '' : `<button class="rc-del" onclick="event.stopPropagation();askDel(${r.id})" aria-label="Borrar: ${r.text}">‚úï</button>`;

          html += `
            <div class="rc${doneClass}" style="border-left-color:${color}" onclick="toggleReminder(${r.id})">
              <div class="rc-chk${chkClass}" style="${chkStyle}">${chkContent}</div>
              <div class="rc-body">
                <div class="rc-txt">${r.text}</div>
                <div class="rc-time"><span class="rc-dot" style="background:${color}"></span>${r.time}</div>
              </div>
              ${delBtn}
            </div>`;
        }
      });
      list.innerHTML = html;
    }

    /* ‚îÄ‚îÄ‚îÄ Actions ‚îÄ‚îÄ‚îÄ */
    function toggleReminder(id) {
      const r = reminders.find(r => r.id === id);
      if (r) {
        playTone(r.done ? 'undo' : 'complete');
        r.done = !r.done;
      }
      confirmDelId = null;
      render();
    }

    function askDel(id) { confirmDelId = id; render(); }
    function cancelDel() { confirmDelId = null; render(); }
    function confirmDelete(id) { reminders = reminders.filter(r => r.id !== id); confirmDelId = null; render(); }

    function switchTab(t) {
      currentTab = t;
      confirmDelId = null;
      document.getElementById('tabHoy').classList.toggle('act', t === 'hoy');
      document.getElementById('tabListo').classList.toggle('act', t === 'listo');
      render();
    }

    function toggleForm() {
      formOpen = !formOpen;
      document.getElementById('addForm').classList.toggle('open', formOpen);
      document.getElementById('fabAdd').textContent = formOpen ? '‚úï' : '+';
      if (formOpen) document.getElementById('newText').focus();
    }

    function addReminder() {
      const text = document.getElementById('newText').value.trim();
      if (!text) return;
      playTone('add');
      const time = document.getElementById('newTime').value;
      reminders.push({ id: Date.now(), text, time, cat: newCat, done: false });
      document.getElementById('newText').value = '';
      newCat = 'personal';
      renderCatPills();
      toggleForm();
      render();
    }

    function selectMood(val) {
      currentMood = val;
      playTone('mood');
      document.querySelectorAll('#moodGrid .mood-btn').forEach(btn => {
        btn.classList.toggle('sel', btn.dataset.val === val);
      });
      const resp = document.getElementById('moodResp');
      resp.textContent = MOOD_RESP[val];
      resp.style.opacity = '1';
    }

    function selectCIMood(val) {
      ciMood = val;
      playTone('mood');
      document.querySelectorAll('#ciMoodGrid .ci-mood-btn').forEach(btn => {
        btn.classList.toggle('sel', btn.dataset.val === val);
      });
    }

    function selectCat(id) {
      newCat = id;
      renderCatPills();
    }

    /* ‚îÄ‚îÄ‚îÄ Check-in ‚îÄ‚îÄ‚îÄ */
    function openCheckin() {
      ciMood = null;
      document.getElementById('ciNote').value = '';
      document.getElementById('checkinContent').classList.remove('hidden');
      document.getElementById('checkinSuccess').classList.add('hidden');
      document.getElementById('checkinOverlay').classList.add('open');
      renderCIMoods();
    }

    function closeCheckinBg(e) {
      if (e.target === document.getElementById('checkinOverlay')) {
        document.getElementById('checkinOverlay').classList.remove('open');
      }
    }

    function submitCheckin() {
      playTone('checkin');
      document.getElementById('checkinContent').classList.add('hidden');
      document.getElementById('checkinSuccess').classList.remove('hidden');
      setTimeout(() => {
        document.getElementById('checkinOverlay').classList.remove('open');
      }, 3000);
    }

    /* ‚îÄ‚îÄ‚îÄ Sound ‚îÄ‚îÄ‚îÄ */
    document.getElementById('soundBtn').addEventListener('click', () => {
      soundOn = !soundOn;
      document.getElementById('soundBtn').textContent = soundOn ? 'üîä' : 'üîá';
    });

    /* ‚îÄ‚îÄ‚îÄ Build UI ‚îÄ‚îÄ‚îÄ */
    function buildMoodGrid() {
      const grid = document.getElementById('moodGrid');
      grid.innerHTML = MOODS.map(m =>
        `<button class="mood-btn" data-val="${m.val}" onclick="selectMood('${m.val}')" aria-label="Me siento ${m.label}">
          <span class="mood-e">${m.emoji}</span>
          <span class="mood-lb">${m.label}</span>
        </button>`
      ).join('');
    }

    function renderCIMoods() {
      const grid = document.getElementById('ciMoodGrid');
      grid.innerHTML = MOODS.map(m =>
        `<button class="ci-mood-btn" data-val="${m.val}" onclick="selectCIMood('${m.val}')" aria-label="Me siento ${m.label}">
          <span class="mood-e" style="font-size:30px">${m.emoji}</span>
          <span class="mood-lb">${m.label}</span>
        </button>`
      ).join('');
    }

    function buildTimeSelect() {
      const sel = document.getElementById('newTime');
      sel.innerHTML = HORAS.map(t => `<option value="${t}">${t}</option>`).join('');
      sel.value = '9:00 AM';
    }

    function renderCatPills() {
      const div = document.getElementById('catPills');
      div.innerHTML = CATS.map(c => {
        const sel = newCat === c.id;
        const style = sel ? `background:${c.color};border-color:${c.color};color:white` : '';
        return `<button class="cpill${sel ? ' sel' : ''}" style="${style}" onclick="selectCat('${c.id}')">${c.icon} ${c.label}</button>`;
      }).join('');
    }

    /* Enter key for form */
    document.getElementById('newText').addEventListener('keydown', (e) => {
      if (e.key === 'Enter') addReminder();
    });

    /* ‚îÄ‚îÄ‚îÄ Init ‚îÄ‚îÄ‚îÄ */
    document.getElementById('fecha').textContent = formatFecha(new Date());
    document.getElementById('saludoText').textContent = getSaludo() + ' ‚òÄÔ∏è';
    document.getElementById('mensajeDiario').textContent = MENSAJES[Math.floor(Math.random() * MENSAJES.length)];

    buildMoodGrid();
    buildTimeSelect();
    renderCatPills();
    render();
  </script>
</body>
</html>